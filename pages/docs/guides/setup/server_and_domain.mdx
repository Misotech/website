import asset from 'next/asset'
import { withDoc } from 'app/lib'
import { Alert, Tip, Info } from 'app/components'

export const meta = {
  title: 'Подготовка к установке',
}

<h1 id="doc-h1">
  {meta.title}
</h1>

## Выбор и подготовка сервера

Rockstat устанавливается на собственный сервер. Подходят как физические, так и виртуальные серверы.

<Alert>
  <strong>Danger! High Voltage! </strong> Rockstat требуется персональный сервер, где нет другого ПО. 
  Установку следует производить только в свежую операционую систему.
  Все необходимое будет установлено автоматически и переконфигурировано под специфику платформы.
</Alert>

### Минимальные требования

- Ресурсы сервера
  - 2+ CPU core
  - 8+ Gb MEM
  - 60+ Gb SSD disk
  - OS Ubuntu **16.04** 64bit;
- Доменное имя, желательно поддомен на основном домене, вроде `rstat.mysite.ru`.

Для тестирования будет достаточно конфигурации вдвое меньше.
На больших нагрузках 5+ миллионов визитов в месяц требуется более производительная конфигурация.

### Выбор поставщика

Для размещения в России хорошим вариантом является [Vscale](https://vscale?utm_source=rock.st),
за границей будет достаточно бюджетного [Hetzner](https://hetzner.de?utm_source=rock.st).
При больших нагрузках можно использовать физические серверы.

### Запуск сервера

Процедура установки и запуска сервера описана на примере облачного провайдера [Vscale](https://vscale.io/?utm_source=rock.st).
После регистрации в личном кабинете можно сразу переходить к созданию сервера.
На стартовом экране нажимаем **Создать сервер** и выбираем операционную систему **Ubuntu 16.04** 64bit.

![vscale start server](/static/images/docs/setup/vscale_select_os.jpg)

Размер сервера:

![vscale choose size](/static/images/docs/setup/vscale_select_size.jpg)

Выбирается локация, имя сервера, после чего можно запустить процесс создания:

![vscale start server](/static/images/docs/setup/vscale_select_loc_name_create.jpg)

Обязательно запишите имя пользователя и пароль.

![vscale start server](/static/images/docs/setup/vscale_credentials.jpg)

Несколько секунд и сервер готов! Запишите IP-адрес сервера.

![vscale start server](/static/images/docs/setup/vscale_created.jpg)


## Конфигурация DNS

Сервер должен иметь доменное имя, лучше всего использовать поддомен основного домена, 
например `rstat.mysite.ru`. Требуется направить доменное имя на ip адрес сервера.

### Базовые принципы конфигурации DNS зоны

К этому моменту у вас должен быть запущен сервер с установленной операционной системой.
Добавьте 2 дополнительные записи в описание зоны DNS:

```
поддомен       A   1.2.3.4
*.поддомен     A   1.2.3.4
```

Пример:

```
rstat         A   46.161.39.109
*.rstat       A   46.161.39.109
```

Как правило, требуется указывать только поддомен, пропуская имя домена.

В зависимости от сервиса, где обслуживается ваш домен, процесс внесения данных может сильно разниться.
Внимание! DNS настраивается **не там**, где расположен сервер, а там, 
где зарегистрирован или обслуживается домен. Уточните этот вопрос у вашего системного администратора. 

#### Открыть интерфейс управления DNS в VScale

![Vscale example](/static/images/docs/setup/vscale_dns_setup.jpg)

#### Интерфейс управления DNS в Amazon AWS

![Aws zone overview](/static/images/docs/setup/aws_dns_setup.jpg)


export default withDoc({...meta})(({children}) => <>{children}</>)
