{"data":"<h1 id=\"-\">Обогащение на сервере</h1>\n<p>При получении данных на вход, серверная часть трекера производит обогащение данных на осноые доступных источников. В данный момент их 3, но архитектура подоготовлена для того, чтобы их было много и в скором времени список будет пополнен.</p>\n<h2 id=\"core\">Core</h2>\n<p>Это не совсем обогатитель, но дописывает параметры уровня HTTP при получении данных</p>\n<pre><code class=\"language-json\">  &quot;ip&quot;: &quot;172.17.121.1&quot;, // ip\n  &quot;userAgent&quot;: &quot;Mozilla/5.0 (Macintosh; Intel Mac OS X 10_13_2) ...Chrome/63.0.3239.132 Safari/537.36&quot;,\n  &quot;time&quot;: &quot;&#39;Fri Mar 16 2018 01:04:33 GMT (GMT)&#39;&quot;</code></pre>\n<h2 id=\"matomo-device-detector\">Matomo Device Detector</h2>\n<p>Обогатитель на базе библиотекти разбора User-Agent из Matomo (Piwik)</p>\n<pre><code class=\"language-json\">\n  // Результаты разбора user-agent\n  &quot;mdd&quot;: {\n    &quot;isBot&quot;: 0, // Признак бота, если он представился, как делают поисковые и аналитические боты\n    &quot;os&quot;: {\n      &quot;name&quot;: &quot;Mac&quot;,\n      &quot;platform&quot;: &quot;&quot;,\n      &quot;version&quot;: &quot;10.13&quot;,\n    },\n    // Если визит с мобильного телефона, будет показывать производителя и модель аппарата\n    &quot;device&quot;: { \n      &quot;brand&quot;: &quot;&quot;,\n      &quot;model&quot;: &quot;&quot;,\n      &quot;type&quot;: &quot;desktop&quot;,\n    },\n    // Может быть мобильное приложение, телевизор или игровая консоль\n    &quot;client&quot;: {\n      &quot;type&quot;: &quot;browser&quot;,\n      &quot;name&quot;: &quot;Chrome&quot;,\n      &quot;version&quot;: &quot;63.0&quot;,\n    }\n  }\n</code></pre>\n<h2 id=\"sypex-geo-ip\">Sypex Geo IP</h2>\n<p>Обогатитель определяющий регион по IP на базе библиотеки Sypex Geo</p>\n<pre><code class=\"language-json\">\n  // Результаты гео-кодинга по ip\n  &quot;sxg&quot;: {\n    &quot;city&quot;: {\n      &quot;id&quot;: 524901,\n      &quot;name_en&quot;: &quot;Moscow&quot;,\n      &quot;name_ru&quot;: &quot;Москва&quot;\n    },\n    &quot;region&quot;: {\n      &quot;iso&quot;: &quot;RU-MOW&quot;,\n      &quot;name_en&quot;: &quot;Moskva&quot;,\n      &quot;name_ru&quot;: &quot;Москва&quot;\n    },\n    &quot;country&quot;: {\n      &quot;iso&quot;: &quot;RU&quot;,\n      &quot;name_en&quot;: &quot;Russia&quot;,\n      &quot;name_ru&quot;: &quot;Россия&quot;\n    }\n  }\n</code></pre>\n<h2 id=\"page-url-parser\">Page url parser</h2>\n<p>Это очень простой обогатитель, разбирающий на кусочки адрес страницы на которой произошло событие</p>\n<pre><code class=\"language-json\">\n  &quot;page&quot;: {\n    &quot;domain&quot;: &quot;somedomain.ru&quot;,\n    &quot;proto&quot;: &quot;https&quot;\n    &quot;query&quot;: {\n      &quot;aaa&quot;: &quot;bbb&quot;,\n      &quot;utm_source&quot;: &quot;youporn&quot;\n    }\n  }\n</code></pre>\n"}