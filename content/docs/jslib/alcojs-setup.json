{"data":"<h1 id=\"-\">Установка счетчика на сайт</h1>\n<h2 id=\"-\">Подготовка сниппета</h2>\n<pre><code class=\"language-html\">&lt;script type=&quot;text/javascript&quot;&gt;\n  !function (w, d, st, rst, se, he) {\n    if(w.rstat) return; rst = w.rstat = function () {\n      var args = Array.prototype.slice.call(arguments);\n      return rst.doCall ? rst.doCall.call(rst, args) : rst._q.push(args); };\n    rst.push = rst; rst._l = !0; rst._sv = 3.0; rst._q = [];\n    rst._jsl = function (src) {\n      se = d.createElement(st); se.async = !0; se.src = src;\n      he = d.getElementsByTagName(st)[0]; he.parentNode.insertBefore(se, he); };\n    rst.attach = function(host){ rst._host = host; rst._jsl(&#39;https://&#39;+rst._host+&#39;/lib.js&#39;); }\n  }(window, document, &#39;script&#39;);\n  // Configuration\n  rstat(&#39;configure&#39;, {\n    projectId: 1 // &lt;&lt;&lt; придумайте номер сайта, если их несколько\n  });\n  rstat(&#39;page&#39;); // &lt;&lt;&lt; отправка просмотра страницы, убирается на SPA\n  rstat.attach(&#39;tracker.rockstat.test&#39;) // &lt;&lt;&lt; Подставьте домен, на котором расположен трекер\n  //rstat(&#39;onReady&#39;, function(){\n  //  console.log(&#39;rstat` ready callback! uid:&#39;, rstat(&#39;getUid&#39;));\n  //});\n  //rstat(&#39;onEvent&#39;, function(name, data){\n  //  console.log(&#39;rstat event callback:&#39;, name, data);\n  //});\n  //rstat(&#39;onServerMessage&#39;, &#39;sm&#39;, function(name, data){\n  //  console.log(&#39;onServerMessage&#39;, name, data);\n  //});\n&lt;/script&gt;</code></pre>\n<p>В коде вместо <code>TRACKER_DOMAIN</code> нужно подставить, домен на котором расположен трекер.<br>Лучше всего установить код между <code>&lt;head&gt;</code> и <code>&lt;/head&gt;</code> или сразу после <code>&lt;body&gt;</code>. Можно поставить через Google Tag Manager, тут есть свои плюсы, минусы и особенности, надо проверять.</p>\n<p><strong>Доступные параметры</strong></p>\n<table>\n<thead>\n<tr>\n<th>Property</th>\n<th>Type</th>\n<th>Default</th>\n<th>Description</th>\n</tr>\n</thead>\n<tbody><tr>\n<td>projectId</td>\n<td>Number</td>\n<td>1</td>\n<td>Произвольный ID сайта/проекта/чего-то еще</td>\n</tr>\n<tr>\n<td>sessionTimeout</td>\n<td>Number</td>\n<td>1800</td>\n<td>Тайм-аут сессии: сколько времени с   последнего события должно пройти</td>\n</tr>\n<tr>\n<td>lastCampaignExpires</td>\n<td>Number</td>\n<td>7776000</td>\n<td>Период, на который запоминаются   последние рекламные метки. Указывается в секундах.</td>\n</tr>\n<tr>\n<td>cookieDomain</td>\n<td>String</td>\n<td>auto</td>\n<td>Домен</td>\n</tr>\n<tr>\n<td>trackActivity</td>\n<td>Boolean</td>\n<td>true</td>\n<td>Флаг автоматического отслеживания   активности посетителей на сайте. Отслеживается движение мышью</td>\n</tr>\n<tr>\n<td>trackClicks</td>\n<td>Boolean</td>\n<td>true</td>\n<td>Автоматическое отслеживание   кликов. Обрабатывает все клики и автоматически классифицирует их на   внутренние и внешние</td>\n</tr>\n<tr>\n<td>trackForms</td>\n<td>Boolean</td>\n<td>true</td>\n<td>Автоматическое отслеживание   взаимодействий с формами. Генерирует события фокуса</td>\n</tr>\n<tr>\n<td>allowHTTP</td>\n<td>Boolean</td>\n<td>false</td>\n<td>По дефолту работает только на   https. Этим параметром можете разрешить работу на http</td>\n</tr>\n</tbody></table>\n<h2 id=\"-gtm\">Через GTM</h2>\n<h3 id=\"-rockstat\">Создание тега Rockstat</h3>\n<p>Создайте новый Пользовательский HTML тег, вставьте ваш код счетчика Rockstat.\nВ расширенных настройках поставьте &quot;Приоритет активации тегов&quot; равным 100.</p>\n<p><img src=\"/static/media/alcojs_setup/gtm_tag_creation.png\" alt=\"\"></p>\n<p>В триггерах выберите All Pages / Все страницы\nЖмем сохранить, указываем имя, например Rockstat</p>\n<h3 id=\"-datalayer\">События, отправляемые с сайта через dataLayer</h3>\n<p>Выбираем тип тега &quot;Пользовательский HTML&quot;</p>\n<pre><code class=\"language-javascript\">&lt;script type=&quot;text/javascript&quot;&gt;\n  var name = ({{category}} || &#39;&#39;) + &#39;::&#39; + ({{action}} || &#39;&#39;);\n  var data = {};\n  if({{label}}) data.label = {{label}};\n  if({{value}}) data.value = {{value}};\n  alco(&#39;event&#39;, name, data)\n&lt;/script&gt;</code></pre>\n<p>вместо category, action, label, value подставьте переменные, используемые у вас для передачи этих данных в GA.</p>\n<p>Выбираем триггер, используемый для отправки пользовательских событий в Google (Universal) Analytics.</p>\n<p>Жмем сохранить, указываем имя, например Custom Events to Rockstat</p>\n<h3 id=\"-ga-gtm\">События GA, размеченные через GTM</h3>\n<p>Вам необходимо найти все теги, созданные для отслеживания действий и передачи их в Google (Universal) Analytics, и для каждого их них в расширенных настройках включить активацию тега после. При выборе тега можно сразу создать пользовательский HTML тег, вызывающий событие Rockstat.</p>\n<p><img src=\"/static/media/alcojs_setup/activate_gtm_tag.png\" alt=\"\"></p>\n<p><img src=\"/static/media/alcojs_setup/choose_gtmtag.png\" alt=\"\"></p>\n<p>Содержимое тега</p>\n<pre><code class=\"language-javascript\">&lt;script type=&quot;text/javascript&quot;&gt;\n  alco(&#39;event&#39;, &#39;CATEGORY::ACTION&#39;, {\n    label: &#39;LABEL&#39;,\n    value: &#39;VALUE&#39;\n  })\n&lt;/script&gt;</code></pre>\n<p>Вместо CATEGORY, ACTION, LABEL, VALUE подставьте соответствующие значения. Если Label или Value события отсутствуют, просто удалите соответствующую строку.</p>\n"}