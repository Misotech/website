{"data":"<h1 id=\"-alcojs\">Подписка на события AlcoJS</h1>\n<h2 id=\"-\">Успешная загрузка</h2>\n<pre><code class=\"language-javascript\">alco(<span class=\"hljs-string\">'onReady'</span>, <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\"></span>)</span>{\n  <span class=\"hljs-built_in\">console</span>.log(<span class=\"hljs-string\">'alco ready callback! uid:'</span>, alco(<span class=\"hljs-string\">'getUid'</span>));\n});\n\n<span class=\"hljs-comment\">//&gt; alco ready callback! uid: 4752253616879771366</span></code></pre>\n<p>Если трекер уже загружен, коллбек будет выполнен сразу</p><h2 id=\"-alco-user-id\">Получение Alco User ID</h2>\n<pre><code class=\"language-javascript\"><span class=\"hljs-function\"><span class=\"hljs-title\">alco</span><span class=\"hljs-params\">(<span class=\"hljs-string\">'getUid'</span>)</span></span></code></pre>\n<p>Но получить его можно только после загрузки трекера, поэтому следует оборачивать в обработчик загрузки</p><pre><code class=\"language-javascript\">alco(<span class=\"hljs-string\">'onReady'</span>, <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\"></span>)</span>{\n  <span class=\"hljs-built_in\">console</span>.log(<span class=\"hljs-string\">'alcoUID:'</span>,alco(<span class=\"hljs-string\">'getUid'</span>));\n});\n\n<span class=\"hljs-comment\">// Или так</span>\n\nalco(<span class=\"hljs-string\">'onReady'</span>, <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span>(<span class=\"hljs-params\"></span>)</span>{\n  dataLayer.push({\n    <span class=\"hljs-string\">'alcoUserId'</span>: alco(<span class=\"hljs-string\">'getUid'</span>)\n  });\n});</code></pre>\n<pre><code class=\"language-javascript\"></code></pre>\n<h2 id=\"-\">Подписка на все события</h2>\n<p>Еще до того, как данные будут отправлены на сервер, они станут доступны на странице</p><pre><code class=\"language-javascript\">alco(<span class=\"hljs-string\">'onEvent'</span>, function(<span class=\"hljs-keyword\">name</span>, <span class=\"hljs-keyword\">data</span>){\n  <span class=\"hljs-comment\">//... your code here</span>\n  console.<span class=\"hljs-built_in\">log</span>(<span class=\"hljs-keyword\">name</span>, <span class=\"hljs-keyword\">data</span>);\n});</code></pre>\n<pre><code class=\"language-javascript\">alco(<span class=\"hljs-string\">'onEvent'</span>, <span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span><span class=\"hljs-params\">(name, data)</span></span>{\n  <span class=\"hljs-comment\">// Ловим событие ошибки при заполнении адреса доставки</span>\n  <span class=\"hljs-keyword\">if</span> (name === <span class=\"hljs-string\">'Form invalid'</span> &amp;&amp; data.fname === <span class=\"hljs-string\">'delivery'</span>) {\n    <span class=\"hljs-comment\">// Ждем 5 секунд</span>\n    setTimeout(<span class=\"hljs-function\"><span class=\"hljs-keyword\">function</span><span class=\"hljs-params\">()</span></span>{\n      <span class=\"hljs-comment\">// Открываем окно чата, передаем пометку оператору</span>\n      SomeChat.openChat({info: <span class=\"hljs-string\">'Проблемы с заполнением формы доставки'</span>});\n      <span class=\"hljs-comment\">// Передаем событие открытия чата в Rockstat, чтобы можно было оценить эффективность</span>\n      aclo(<span class=\"hljs-string\">'event'</span>, <span class=\"hljs-string\">'Chat Opened'</span>, {reason: <span class=\"hljs-string\">'Invalid delivery details'</span>})\n    }), <span class=\"hljs-number\">5</span>*<span class=\"hljs-number\">1000</span>);\n  }\n});</code></pre>\n"}