{"data":"<h1 id=\"-\">Обогащение данными</h1>\n<p>Сгенерировав событие <code>{name: &quot;ping&quot;}</code>, мы молучим</p><pre><code class=\"language-json\">{\n  <span class=\"hljs-string\">//</span> Название события\n  <span class=\"hljs-string\">\"name\"</span>: <span class=\"hljs-string\">\"ping\"</span>,\n  <span class=\"hljs-string\">//</span> Идентификатор сайта или чего-то другого. Назначается при установке кода\n  <span class=\"hljs-string\">\"projectId\"</span>: 1,\n  <span class=\"hljs-string\">//</span> Межсайтовый user-id Rockstat\n  <span class=\"hljs-string\">\"uid\"</span>: <span class=\"hljs-string\">\"4752253121879771366\"</span>,\n  <span class=\"hljs-string\">//</span> Это данные события <span class=\"hljs-string\">\"Field change\"</span>, у других другие\n  <span class=\"hljs-string\">\"data\"</span>: {},\n  <span class=\"hljs-string\">//</span> Информация о пользователе\n  <span class=\"hljs-string\">\"user\"</span>: {\n    <span class=\"hljs-string\">//</span> id посетителя из Google Analytics и Yandex Metrika\n    <span class=\"hljs-string\">\"gaId\"</span>: <span class=\"hljs-string\">\"349777458.1984110030\"</span>,\n    <span class=\"hljs-string\">\"ymId\"</span>: <span class=\"hljs-string\">\"1513110030702009110\"</span>,\n    <span class=\"hljs-string\">//</span> id пользователя с сайта, на котором установлен счетчик. Устанавливается через indentify\n    <span class=\"hljs-string\">\"id\"</span>: <span class=\"hljs-string\">\"Neiw7kaireiThohYo7ath5\"</span>,\n    <span class=\"hljs-string\">//</span> Произвольные идентификационные данные с сайта, которые в дальнейшем могут пригодиться.\n    <span class=\"hljs-string\">//</span> Привязываются через js api, хранятся у посетителя в браузере <span class=\"hljs-params\">(localStorage)</span>\n    <span class=\"hljs-string\">\"traits\"</span>: {\n      <span class=\"hljs-string\">\"transactionId\"</span>: <span class=\"hljs-string\">\"your_user_transaction_id\"</span>,\n      <span class=\"hljs-string\">\"userSegment\"</span>: <span class=\"hljs-string\">\"some_segment\"</span>,\n      <span class=\"hljs-string\">//....</span>\n    }\n  },\n  <span class=\"hljs-string\">//</span> Информация о странице\n  <span class=\"hljs-string\">\"page\"</span>: {\n    <span class=\"hljs-string\">//</span> полный адрес страницы c запросом и якорем\n    <span class=\"hljs-string\">\"url\"</span>: <span class=\"hljs-string\">\"https://oooooo.ru/checkout/form?aaa=bbb&amp;c=who\"</span>,\n    <span class=\"hljs-string\">//</span> реферер / прерыдущая страница\n    <span class=\"hljs-string\">\"referrer\"</span>: <span class=\"hljs-string\">\"https://oooooo.ru/cart\"</span>,\n    <span class=\"hljs-string\">//</span> часть адреса страницы | путь\n    <span class=\"hljs-string\">\"title\"</span>: <span class=\"hljs-string\">\"На этом месте был совершенно типовой заголовок\"</span>,\n    <span class=\"hljs-string\">//</span> протокол\n    <span class=\"hljs-string\">\"proto\"</span>: <span class=\"hljs-string\">\"https\"</span>\n  },\n  <span class=\"hljs-string\">//</span> Данные сессии\n  <span class=\"hljs-string\">\"session\"</span>: {\n    <span class=\"hljs-string\">//</span> Идентификатор крупного игрока рынка\n    <span class=\"hljs-string\">\"session_engine\"</span>: <span class=\"hljs-string\">\"google\"</span>,\n    <span class=\"hljs-string\">//</span> Номер события за текущий визит <span class=\"hljs-params\">(страницы не считаются)</span>\n    <span class=\"hljs-string\">\"session_eventNum\"</span>: 183,\n    <span class=\"hljs-string\">//</span> Тут могли бы быть ваши рекламные метки\n    <span class=\"hljs-string\">\"session_marks\"</span>: {\n      <span class=\"hljs-string\">//</span> Например флаг, что имеется gclid\n      <span class=\"hljs-string\">\"has_gclid\"</span>: 1\n    },\n    <span class=\"hljs-string\">\"session_hasMarks\"</span>: 0,    \n    <span class=\"hljs-string\">//</span> Номер визита этого пользователя\n    <span class=\"hljs-string\">\"session_num\"</span>: 2,\n    <span class=\"hljs-string\">//</span> Номер просмотра страницы за эту сессию\n    <span class=\"hljs-string\">\"session_pageNum\"</span>: 18,                        \n    <span class=\"hljs-string\">//</span> Домен реферера\n    <span class=\"hljs-string\">\"session_refHost\"</span>: <span class=\"hljs-string\">\"google.ru\"</span>,   \n    <span class=\"hljs-string\">//</span> Время начала сессии\n    <span class=\"hljs-string\">\"session_start\"</span>: <span class=\"hljs-string\">\"1518857893459\"</span>,\n    <span class=\"hljs-string\">//</span> Тип визита\n    <span class=\"hljs-string\">\"session_type\"</span>: <span class=\"hljs-string\">\"organic\"</span>\n  },\n  <span class=\"hljs-string\">//</span> Информация о версии бибилиотеки Rockstat которая использовалась для сбора данных\n  <span class=\"hljs-string\">\"library\"</span>: {\n    <span class=\"hljs-string\">\"name\"</span>: <span class=\"hljs-string\">\"alco.js\"</span>,\n    <span class=\"hljs-string\">\"libver\"</span>: 104,\n    <span class=\"hljs-string\">\"snippet\"</span>: 1\n  },\n  <span class=\"hljs-string\">//</span> Блок информации о клиенте <span class=\"hljs-params\">(браузере)</span>\n  <span class=\"hljs-string\">\"client\"</span>: {\n    <span class=\"hljs-string\">//</span> Время у посетителя в браузере\n    <span class=\"hljs-string\">\"ts\"</span>: 1518872176934,\n    <span class=\"hljs-string\">//</span> Тестовый часовой пояс\n    <span class=\"hljs-string\">\"tz\"</span>: <span class=\"hljs-string\">\"MSK\"</span>,\n    <span class=\"hljs-string\">//</span> Смещение времени относительно UTC <span class=\"hljs-params\">(мировое координационное время)</span>\n    <span class=\"hljs-string\">\"tzOffset\"</span>: 180000,\n    <span class=\"hljs-string\">//</span> Платформа компьютера\n    <span class=\"hljs-string\">\"platform\"</span>: <span class=\"hljs-string\">\"MacIntel\"</span>,\n    <span class=\"hljs-string\">//</span> Все кроме IE пишут так\n    <span class=\"hljs-string\">\"product\"</span>: <span class=\"hljs-string\">\"Gecko\"</span>\n  },\n  <span class=\"hljs-string\">//</span> Статус полезных функций браузера\n  <span class=\"hljs-string\">\"cf\"</span>: {\n    <span class=\"hljs-string\">//</span> localstorage\n    <span class=\"hljs-string\">\"locstor\"</span>: <span class=\"hljs-literal\">true</span>,\n    <span class=\"hljs-string\">//</span> addEventListener\n    <span class=\"hljs-string\">\"addel\"</span>: <span class=\"hljs-literal\">true</span>,\n    <span class=\"hljs-string\">//</span> Promise\n    <span class=\"hljs-string\">\"promise\"</span>: <span class=\"hljs-literal\">true</span>,\n    <span class=\"hljs-string\">//</span> sendBeacon\n    <span class=\"hljs-string\">\"sbeacon\"</span>: <span class=\"hljs-literal\">true</span>,\n    <span class=\"hljs-string\">//</span> base64\n    <span class=\"hljs-string\">\"atob\"</span>: <span class=\"hljs-literal\">true</span>,\n  },\n  <span class=\"hljs-string\">\"browser\"</span>: {\n    <span class=\"hljs-string\">//</span> детектор iframe <span class=\"hljs-params\">(можно вычислять мошенничество)</span>\n    <span class=\"hljs-string\">\"if\"</span>: [0, 2],\n    <span class=\"hljs-string\">//</span> Размер окна браузера\n    <span class=\"hljs-string\">\"wh\"</span>: {\n      <span class=\"hljs-string\">\"w\"</span>: 1440,\n      <span class=\"hljs-string\">\"h\"</span>: 330\n    },\n    <span class=\"hljs-string\">\"sr\"</span>: {\n      <span class=\"hljs-string\">//</span> разрешение экрана\n      <span class=\"hljs-string\">\"tot\"</span>: {\n        <span class=\"hljs-string\">\"w\"</span>: 1440,\n        <span class=\"hljs-string\">\"h\"</span>: 900\n      },\n      <span class=\"hljs-string\">//</span> доступная часть экрана <span class=\"hljs-params\">(макс размер браузера)</span>\n      <span class=\"hljs-string\">\"avail\"</span>: {\n        <span class=\"hljs-string\">\"w\"</span>: 1440,\n        <span class=\"hljs-string\">\"h\"</span>: 837\n      },\n      <span class=\"hljs-string\">//</span> уплотнение экрана <span class=\"hljs-params\">(retina и тп)</span>\n      <span class=\"hljs-string\">\"asp\"</span>: 2000,\n      <span class=\"hljs-string\">//</span> угол поворота <span class=\"hljs-params\">(для мобилок)</span>\n      <span class=\"hljs-string\">\"oAngle\"</span>: 0,\n      <span class=\"hljs-string\">//</span> положение экрана\n      <span class=\"hljs-string\">\"oType\"</span>: <span class=\"hljs-string\">\"landscape-primary\"</span>\n    }\n  },\n  <span class=\"hljs-string\">//</span> Информация о положении на странице в момент происхождения события\n  <span class=\"hljs-string\">//</span> нет у session, pageview, Page loaded\n  <span class=\"hljs-string\">\"scroll\"</span>: {\n    <span class=\"hljs-string\">//</span> высота документа\n    <span class=\"hljs-string\">\"docHeight\"</span>: 1999,\n    <span class=\"hljs-string\">//</span> высота окна\n    <span class=\"hljs-string\">\"clientHeight\"</span>: 330,\n    <span class=\"hljs-string\">//</span> скролл в пикселях\n    <span class=\"hljs-string\">\"topOffset\"</span>: 0,\n    <span class=\"hljs-string\">//</span> текущий скролл\n    <span class=\"hljs-string\">\"scroll\"</span>: 0,\n    <span class=\"hljs-string\">//</span>Максимальный скролл\n    <span class=\"hljs-string\">\"maxScroll\"</span>: 100\n    <span class=\"hljs-string\">//</span> C помошью этих данных довольно легко можно определить, где именно находился посетитель\n  },\n  <span class=\"hljs-string\">//</span> Данные о скорости загрузки, ms. Есть в событиях <span class=\"hljs-string\">\"pageview\"</span> и <span class=\"hljs-string\">\"Page loaded\"</span>\n  <span class=\"hljs-string\">//</span> Подробная информация: https:<span class=\"hljs-string\">//developer.mozilla.org/en-US/docs/Web/API/PerformanceTiming</span>\n  <span class=\"hljs-string\">\"perf\"</span>: {\n    <span class=\"hljs-string\">//</span> <span class=\"hljs-keyword\">connect</span> start: точка отсчета, всегда 0\n    <span class=\"hljs-string\">\"cs\"</span>: 0,\n    <span class=\"hljs-string\">//</span> <span class=\"hljs-keyword\">connect</span> end: время завершения подключения в случае ошибки\n    <span class=\"hljs-string\">\"ce\"</span>: 0,\n    <span class=\"hljs-string\">//</span> secure сonnection start:\n    <span class=\"hljs-string\">\"scs\"</span>: -1,\n    <span class=\"hljs-string\">//</span> request start: отправка запроса на сервер\n    <span class=\"hljs-string\">\"rqs\"</span>: 2,\n    <span class=\"hljs-string\">//</span> response start: начало передачи html с сервера\n    <span class=\"hljs-string\">\"rss\"</span>: 37,\n    <span class=\"hljs-string\">//</span> response end: содержимое страницы получено\n    <span class=\"hljs-string\">\"rse\"</span>: 44,\n    <span class=\"hljs-string\">//</span> dom loading: начало обработки html и загрузки js\n    <span class=\"hljs-string\">\"dl\"</span>: 53,\n    <span class=\"hljs-string\">//</span> dom interactive: загружены html и js, страница готова\n    <span class=\"hljs-string\">\"di\"</span>: 227,\n    <span class=\"hljs-string\">//</span> dom complete: загружены все картинки и стили, загрузка полностью завершена\n    <span class=\"hljs-string\">\"dc\"</span>: 481\n  }\n}</code></pre>\n"}